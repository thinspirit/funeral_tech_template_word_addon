function readFile(){var e=document.getElementById("fileInput").files[0];if(e){var n=new FileReader;n.onload=function(n){var t=n.target.result;e.name.endsWith(".csv")&&Papa.parse(t,{complete:function(e){populateFields(e.data.map((function(e){return e[0]})))}})},n.readAsText(e)}}function populateFields(e){var n=document.getElementById("fieldList");n.innerHTML="",e.forEach((function(e){var t=document.createElement("div");t.textContent=e,t.className="fieldItem",n.appendChild(t)}))}function filterFields(){var e=document.getElementById("searchInput").value.toLowerCase();document.querySelectorAll(".fieldItem").forEach((function(n){n.textContent.toLowerCase().includes(e)?n.style.display="block":n.style.display="none"}))}function showMenu(e){e.stopPropagation();var n=document.querySelector(".menu");n&&n.remove();var t=document.getElementById("menuTemplate").cloneNode(!0);t.style.display="block",t.className="menu";var a=e.target.closest(".fieldItem").textContent.trim();t.querySelectorAll(".menuOption").forEach((function(e){e.addEventListener("click",(function(e){e.stopPropagation();var n=e.target.getAttribute("data-type");insertAdvancedField(a,n),t.remove()}))})),e.target.appendChild(t)}function insertAdvancedField(e,n){Word.run((function(t){var a=t.document.getSelection();return t.load(a),t.sync().then((function(){var r="";switch(n){case"fullText":r=generateFullTextOoxml(e);break;case"firstLetter":r=generateFirstLetterOoxml(e);break;case"booleanCheckbox":r=generateBooleanCheckboxOoxml(e);break;default:return}return a.insertOoxml(r,Word.InsertLocation.end),t.sync()}))}))}function generateFullTextOoxml(e){return'<pkg:package xmlns:pkg="http://schemas.microsoft.com/office/2006/xmlPackage">\n  <pkg:part pkg:name="/_rels/.rels" pkg:contentType="application/vnd.openxmlformats-package.relationships+xml" pkg:padding="512">\n    <pkg:xmlData>\n      <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n        <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="word/document.xml"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n  <pkg:part pkg:name="/word/document.xml" pkg:contentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml">\n    <pkg:xmlData>\n      <w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">\n        <w:body>\n          <w:p>\n            <w:r>\n              <w:fldChar w:fldCharType="begin"/>\n            </w:r>\n            <w:r>\n              <w:instrText xml:space="preserve"> MERGEFIELD '.concat(e,' </w:instrText>\n            </w:r>\n            <w:r>\n              <w:fldChar w:fldCharType="end"/>\n            </w:r>\n          </w:p>\n        </w:body>\n      </w:document>\n    </pkg:xmlData>\n  </pkg:part>\n</pkg:package>')}function generateFirstLetterOoxml(e){for(var n='<pkg:package xmlns:pkg="http://schemas.microsoft.com/office/2006/xmlPackage">\n  <pkg:part pkg:name="/_rels/.rels" pkg:contentType="application/vnd.openxmlformats-package.relationships+xml" pkg:padding="512">\n    <pkg:xmlData>\n      <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n        <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="word/document.xml"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n  <pkg:part pkg:name="/word/document.xml" pkg:contentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml">\n    <pkg:xmlData>\n      <w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">\n        <w:body>\n          <w:p>\n            ',t=65;t<=90;t++){var a=String.fromCharCode(t);n+='<w:r><w:fldChar w:fldCharType="begin"/></w:r>\n              <w:r><w:instrText xml:space="preserve"> IF </w:instrText></w:r>\n              <w:r><w:fldChar w:fldCharType="begin"/></w:r>\n              <w:r><w:instrText xml:space="preserve"> MERGEFIELD '.concat(e,' </w:instrText></w:r>\n              <w:r><w:fldChar w:fldCharType="end"/></w:r>\n              <w:r><w:instrText xml:space="preserve"> = "').concat(a,'*" "').concat(a,'" "" </w:instrText></w:r>\n              <w:r><w:fldChar w:fldCharType="end"/></w:r>')}return n+"</w:p>\n          </w:body>\n        </w:document>\n     </pkg:xmlData>\n    </pkg:part>\n  </pkg:package>"}function generateBooleanCheckboxOoxml(e){return'<pkg:package xmlns:pkg="http://schemas.microsoft.com/office/2006/xmlPackage">\n    <pkg:part pkg:name="/_rels/.rels" pkg:contentType="application/vnd.openxmlformats-package.relationships+xml" pkg:padding="512">\n      <pkg:xmlData>\n        <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n          <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="word/document.xml"/>\n        </Relationships>\n      </pkg:xmlData>\n    </pkg:part>\n    <pkg:part pkg:name="/word/document.xml" pkg:contentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml">\n      <pkg:xmlData>\n        <w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">\n          <w:body>\n            <w:p>\n              <w:r><w:fldChar w:fldCharType="begin"/></w:r>\n              <w:r><w:instrText xml:space="preserve"> IF </w:instrText></w:r>\n              <w:r><w:fldChar w:fldCharType="begin"/></w:r>\n              <w:r><w:instrText xml:space="preserve"> MERGEFIELD '.concat(e,' </w:instrText></w:r>\n              <w:r><w:fldChar w:fldCharType="end"/></w:r>\n              <w:r><w:instrText xml:space="preserve"> = " " "X" "" </w:instrText></w:r>\n              <w:r><w:fldChar w:fldCharType="end"/></w:r>\n            </w:p>\n          </w:body>\n        </w:document>\n      </pkg:xmlData>\n    </pkg:part>\n  </pkg:package>')}function loadDefaultFields(){fetch("assets/field_names.csv").then((function(e){return e.text()})).then((function(e){populateFields(e.split("\n").map((function(e){return e.trim()})))})).catch((function(e){console.error("Error loading default fields:",e)}))}Office.onReady((function(e){e.host===Office.HostType.Word&&(document.getElementById("loadFieldsButton").addEventListener("click",readFile),document.getElementById("loadDefaultFieldsButton").addEventListener("click",loadDefaultFields),document.getElementById("searchInput").addEventListener("input",filterFields),document.body.addEventListener("click",(function(){var e=document.querySelector(".menu");e&&e.remove()})),document.getElementById("fieldList").addEventListener("click",showMenu))}));